import kernel.operators.*;

overloadable move;

[T]
overload move(dest:T, src:T) {
    if (&dest == &src)
        return;
    dest <-- src;
    destroy(src);
}

record Movable[T] {
    data:Pointer[T];
}

[T]
overload move(a:T) = Movable(&a);

[T]
overload dereference(a:Movable[T]) = ref a.data^;
