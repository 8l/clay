
import clay.lexer.*;
import clay.errors.*;

main(args) {
    if (size(args) != 2) {
        println("usage: ", args[0], " <clayfile>");
        return -1;
    }
    var fileName = args[1];
    var data = readAll(File(fileName));
    var input = LexerInput(data);
    try {
        var tokens = tokenize(input);
        for (token in tokens) {
            var code = token.code;
            if ((code == SPACE) or (code == COMMENT))
                continue;
            ref loc = token.location;
            var str = slice(data, loc.start, loc.end);
            println(code, ": ", str);
        }
    }
    catch (e:LexerError) {
        displayError(fileName, data, e.offset, "invalid token");
    }
    return 0;
}
