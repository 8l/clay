import test.*;
import commandline.options.table.*;
import commandline.options.spec.*;
import maybe.*;

import tests.examplespecs.*;

main() = testMain(
  TestSuite("The option table API", [
    TestCase("testing for presence", test => {
      var ot = OptionTable(fbbSpec(), ["-fb", "-baz"]);

      expectTrue(test, "foo is a provided option", optionGiven?(ot, "foo"));
      expectTrue(test, "bar is a provided option", optionGiven?(ot, "foo"));
    }),
    TestCase("getting values", test => {
      var ot = OptionTable(valuableSpec(), ["-fkittens", "--bar=badgers", "--foo", "bunnies"]);

      expectEqual(test, "the values for foo", getOptions(ot, "foo"), Vector[String]([String("kittens"), String("bunnies")]));
      expectEqual(test, "the values for bar", getOptions(ot, "bar"), Vector[String](String("badgers")));
    })
  ]),
);
